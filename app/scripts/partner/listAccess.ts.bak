import 'dotenv/config';
// File: app/scripts/partner/listAccess.ts
import partnerTiers from '@/config/partnerTiers.json' assert { type: 'json' };
import tierDocs from '@/config/tierDocs.json' assert { type: 'json' };

const partners = partnerTiers as Record<string, string>;
const docs = tierDocs as Record<string, string[]>;

console.log('\nğŸ“‹ Partner Tier Access Overview\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

const foundTiers = new Set(Object.keys(docs));
const seenTiers = new Set<string>();

Object.entries(partners).forEach(([partner, tier]) => {
  const pdfs = docs[tier];
  seenTiers.add(tier);

  if (!pdfs) {
    console.warn(`âš ï¸  Tier '${tier}' for partner '${partner}' is not defined in tierDocs.json`);
    console.log(`ğŸ‘¤ ${partner.padEnd(25)} â†’ ğŸ–ï¸ ${tier.padEnd(10)} â†’ âš ï¸ No PDF mapping`);
  } else {
    console.log(`ğŸ‘¤ ${partner.padEnd(25)} â†’ ğŸ–ï¸ ${tier.padEnd(10)} â†’ ğŸ“„ [${pdfs.join(', ')}]`);
  }
});

// Find unused tiers
const unusedTiers = [...foundTiers].filter(t => !seenTiers.has(t));
if (unusedTiers.length > 0) {
  console.warn('\nâš ï¸  Unused tiers defined in tierDocs.json:');
  unusedTiers.forEach(t => {
    const pdfs = docs[t];
    if (!pdfs || pdfs.length === 0) {
      console.warn(`âš ï¸  Tier '${t}' has no PDFs assigned.`);
    } else {
      console.warn(`â„¹ï¸  Tier '${t}' is defined but not assigned to any partner.`);
    }
  });
}

console.log('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n');
