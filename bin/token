#!/bin/bash
# AXPT Token CLI Launcher

source ./app/scripts/verify-env.sh

COMMAND=$1
shift

SCRIPT_DIR="./app/scripts/partner"

case "$COMMAND" in
  generate)
    npx tsx "$SCRIPT_DIR/token.ts" generate "$@"
    ;;
  verify)
    npx tsx "$SCRIPT_DIR/verifyToken.ts" "$@"
    ;;
  list)
    npx tsx "$SCRIPT_DIR/token.ts" list "$@"
    ;;
  lookup)
    npx tsx "$SCRIPT_DIR/token.ts" lookup "$@"
    ;;
  debug-live)
    bin/token-debug-live "$@"
    ;;
  sync-env)
    bin/env-sync "$@"
    ;;
  ""|help|--help|-h)
    echo ""
    echo "üîê AXPT Token CLI"
    echo "------------------"
    echo "Usage:"
    echo "  bin/token generate               # Interactive token creation (JSON + signature)"
    echo "  bin/token verify <token>         # Verify token manually (default: consolidated verifier)"
    echo "  bin/token list                   # List all known partners and tiers"
    echo "  bin/token lookup <partner-name>  # Lookup a specific partner‚Äôs tier"
    echo "  bin/token debug-live             # Verify token using Vercel environment"
    echo "  bin/token sync-env               # Ensure Vercel and local .env values match"
    echo ""
    echo "Examples:"
    echo "  bin/token generate"
    echo "  bin/token verify \"<token>\""
    echo "  bin/token debug-live \"<token>\""
    echo ""
    ;;
  *)
    npx tsx "$SCRIPT_DIR/token.ts" "$COMMAND" "$@"
    ;;
esac
