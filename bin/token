#!/bin/bash
# AXPT Token CLI Launcher

source ./app/scripts/verify-env.sh

COMMAND=$1
shift

SCRIPT_DIR="./app/scripts/partner"

case "$COMMAND" in
  generate)
    # ‚úÖ Route to new unified generator
    npx tsx "$SCRIPT_DIR/token.ts" generate "$@"
    ;;
  verify)
    npx tsx "$SCRIPT_DIR/token.ts" verify "$@"
    ;;
  list)
    npx tsx "$SCRIPT_DIR/token.ts" list "$@"
    ;;
  lookup)
    npx tsx "$SCRIPT_DIR/token.ts" lookup "$@"
    ;;
  ""|help|--help|-h)
    echo ""
    echo "üîê AXPT Token CLI"
    echo "------------------"
    echo "Usage:"
    echo "  bin/token generate               # Interactive token creation (JSON + signature)"
    echo "  bin/token verify <token>         # Verify token manually"
    echo "  bin/token list                   # List all known partners and tiers"
    echo "  bin/token lookup <partner-name>  # Lookup a specific partner‚Äôs tier"
    echo "  bin/token                        # Launch interactive dashboard"
    echo ""
    echo "Examples:"
    echo "  bin/token generate"
    echo "  bin/token verify \"<token>\""
    echo ""
    ;;
  *)
    # üßø Default: fallback to interactive dashboard or custom args
    npx tsx "$SCRIPT_DIR/token.ts" "$COMMAND" "$@"
    ;;
esac